<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="robots" content="noindex" />
    <title>Environments</title>
    <h3>
      <a href="{{ url_for('show_all') }}">Environment Manager</a>
    </h3>
    <script
      src="https://code.jquery.com/jquery-2.2.4.min.js"
      integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
      crossorigin="anonymous"
    ></script>
    <script
      type="text/javascript"
      src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"
    ></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.css"
    />
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.js"
    ></script>
    <style type="text/css">
      .row-index {
        width: 50px;
        display: inline-block;
      }
    </style>

    <script type="text/javascript">
      function startInstance(instance_id) {
          // You can use AJAX to make a POST request to your backend route for starting the instance
          // Don't forget to handle any errors and provide feedback to the user
          alert('Start instance: ' + instance_id);
      }

      function stopInstance(instance_id) {
          // You can use AJAX to make a POST request to your backend route for stopping the instance
          // Don't forget to handle any errors and provide feedback to the user
          alert('Stop instance: ' + instance_id);
      }

      function deleteInstance(instance_id) {
          // Implement your code to delete the EC2 instance with the given instance_id
          // You can use AJAX to make a POST request to your backend route for deleting the instance
          alert('Delete instance: ' + instance_id);
      }

      function actionButtonsFormatter(value, row) {
          return [
              '<button class="btn btn-primary btn-sm" onclick="startInstance(\'' + row.instance_id + '\')">Start</button>',
              '<button class="btn btn-warning btn-sm" onclick="stopInstance(\'' + row.instance_id + '\')">Stop</button>',
              '<button class="btn btn-danger btn-sm" onclick="deleteInstance(\'' + row.instance_id + '\')">Delete</button>'
          ].join(' ');
      }

      $(window).load(function () {
          var data = {{data|tojson}};
          var columns = {{columns|tojson}};

          // Update the columns variable to include action buttons
          columns.push({
              'field': 'Actions',
              'title': 'Actions',
              'formatter': actionButtonsFormatter
          });

          $(function () {
              $('#table').bootstrapTable({
                  data: data,
                  columns: columns,
              });
          });
      });
    </script>
  </head>
  <body>
    <div class="container" style="padding: 10px">
      <h1>{{title}}</h1>
      <br />
      <div id="toolbar"></div>
      <table
        id="table"
        data-toggle="true"
        data-toolbar="#toolbar"
        data-search="true"
        data-show-columns="true"
        data-pagination="true"
        data-show-pagination-switch="true"
        data-height="500"
      ></table>
    </div>
  </body>
</html>
